# https://docs.github.com/en/actions/reference

name: Check
on: push
jobs:

  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: GitHub Actions runner ignores SIGPIPE
        run: |
          set -o | grep -e pipefail -e errexit
          trap
          yes | head -n 1
        shell: bash --noprofile --norc -e -x {0}

      - name: Using Python to run commands, SIGPIPE is not ignored
        run: |
          python3 -c 'from subprocess import run; run(["trap; yes | head -n 1"], shell=True)'
        shell: bash --noprofile --norc -e -x {0}

        # Not supported in Ubuntu 20.04
        #shell: env --default-signal=PIPE bash --noprofile --norc -e {0}
